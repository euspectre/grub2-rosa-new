#!/bin/sh
# If EFI present we need add probing for Windows
if [ -d /sys/firmware/efi ]; then
if [ -d /boot/efi/EFI/Microsoft ]; then
EFI_UUID="$(/usr/sbin/grub2-probe --target=fs_uuid /boot/efi/EFI/Microsoft/Boot/bootmgfw.efi)"

cat << EOF
menuentry "Microsoft Windows Vista/7/8 x86_64 UEFI-GPT" {
  insmod part_gpt
  insmod fat
  insmod search_fs_uuid
  insmod chain
  search --fs-uuid --set=root --hint-bios=hd0,gpt1 --hint-efi=hd0,gpt1 --hint-baremetal=ahci0,gpt1 ${EFI_UUID}
  chainloader /efi/Microsoft/Boot/bootmgfw.efi
}
EOF
fi
fi
